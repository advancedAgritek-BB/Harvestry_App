{
  "Environment": "Production",
  "Logging": {
    "LogLevel": {
      "Default": "Warning",
      "Microsoft": "Error",
      "Microsoft.Hosting.Lifetime": "Information",
      "System": "Error"
    }
  },
  "ConnectionStrings": {
    "PostgreSQL": "Host=${DB_HOST};Port=5432;Database=${DB_NAME};Username=${DB_USER};Password=${DB_PASSWORD};SSL Mode=Require;Trust Server Certificate=false;Include Error Detail=false;Pooling=true;Minimum Pool Size=10;Maximum Pool Size=100",
    "Redis": "${REDIS_HOST}:6379,password=${REDIS_PASSWORD},ssl=true,abortConnect=false,connectRetry=3,connectTimeout=5000"
  },
  "Observability": {
    "ServiceName": "harvestry-api",
    "Environment": "production",
    "OpenTelemetry": {
      "Endpoint": "${OTEL_EXPORTER_OTLP_ENDPOINT}",
      "Protocol": "grpc",
      "BatchExportProcessorOptions": {
        "MaxQueueSize": 2048,
        "ScheduledDelayMilliseconds": 5000,
        "ExporterTimeoutMilliseconds": 30000,
        "MaxExportBatchSize": 512
      }
    },
    "Sentry": {
      "Dsn": "${SENTRY_DSN}",
      "Environment": "production",
      "TracesSampleRate": 0.1,
      "Debug": false,
      "AttachStacktrace": true,
      "SendDefaultPii": false
    }
  },
  "FeatureFlags": {
    "Unleash": {
      "UnleashApi": "${UNLEASH_API_URL}",
      "ApiToken": "${UNLEASH_API_TOKEN}",
      "AppName": "harvestry-api",
      "Environment": "production",
      "RefreshInterval": 60
    }
  },
  "Security": {
    "RLS": {
      "Enabled": true,
      "EnforceUserContext": true
    },
    "JWT": {
      "Secret": "${JWT_SECRET}",
      "Issuer": "harvestry-production",
      "Audience": "harvestry-api",
      "ExpirationMinutes": 15
    },
    "EncryptionKeys": {
      "KMSKeyId": "${KMS_KEY_ID}",
      "Region": "${AWS_REGION}"
    },
    "CORS": {
      "AllowedOrigins": [
        "https://app.harvestry.com",
        "https://www.harvestry.com"
      ]
    }
  },
  "Integrations": {
    "Slack": {
      "WebhookUrl": "${SLACK_WEBHOOK_URL}",
      "BotToken": "${SLACK_BOT_TOKEN}",
      "SigningSecret": "${SLACK_SIGNING_SECRET}"
    },
    "METRC": {
      "BaseUrl": "https://api-ca.metrc.com",
      "VendorApiKey": "${METRC_VENDOR_API_KEY}",
      "UserApiKey": "${METRC_USER_API_KEY}",
      "RateLimitPerMinute": 300,
      "RetryPolicy": {
        "MaxRetries": 3,
        "BackoffMultiplier": 2
      }
    },
    "QuickBooks": {
      "ClientId": "${QBO_CLIENT_ID}",
      "ClientSecret": "${QBO_CLIENT_SECRET}",
      "Environment": "production"
    }
  },
  "RateLimiting": {
    "Enabled": true,
    "PermitLimit": 5000,
    "Window": "00:01:00",
    "QueueLimit": 500
  },
  "HealthChecks": {
    "Enabled": true,
    "Endpoints": [
      "/health/live",
      "/health/ready"
    ]
  },
  "CircuitBreaker": {
    "FailureThreshold": 5,
    "SamplingDuration": "00:01:00",
    "MinimumThroughput": 10,
    "DurationOfBreak": "00:00:30"
  }
}
